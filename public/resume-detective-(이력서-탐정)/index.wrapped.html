<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Resume Detective</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
      body { font-family: 'Noto Sans KR', sans-serif; }
      @keyframes scan {
        0% { top: 0%; opacity: 0; }
        50% { opacity: 1; }
        100% { top: 100%; opacity: 0; }
      }
      .animate-scan {
        animation: scan 2s linear infinite;
      }
    </style>
  
<link rel="stylesheet" href="./index.css">
</head>
  <body class="bg-slate-900 text-slate-100 antialiased overflow-hidden">
    <div id="root"></div>
  

     <!-- Injected by Generator -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script>
      window.process = { env: { API_KEY: "AIzaSyDr73mB7NaPI0oIL-xG5mcRM3Clv12hTxQ" } };
    </script>
    <script type="importmap">
      {
        "imports": {
          "react": "https://esm.sh/react@18.2.0",
          "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
          "lucide-react": "https://esm.sh/lucide-react@0.263.1",
          "@google/genai": "https://esm.sh/@google/genai@0.1.1",
          "recharts": "https://esm.sh/recharts@2.12.0"
        }
      }
    </script>
    <script type="text/babel" data-type="module" data-presets="react,typescript">
      
/* --- Bundled from BriefingCard.tsx --- */
import React, { useEffect } from 'react';

import { Award, Briefcase, GraduationCap, ArrowRight } from 'lucide-react';


interface Props {
  candidate: Candidate;
  onNext: () => void;
}

const BriefingCard: React.FC<Props> = ({ candidate, onNext }) => {
  useEffect(() => {
    audioService.playSuccessSound();
  }, []);

  return (
    <div className="max-w-md w-full mx-auto bg-white rounded-xl shadow-2xl overflow-hidden animate-fade-in-up">
      <div className="bg-blue-600 p-6 text-center relative overflow-hidden">
        {/* Decorative Circles */}
        <div className="absolute top-0 left-0 w-32 h-32 bg-white opacity-10 rounded-full -translate-x-10 -translate-y-10"></div>
        <div className="absolute bottom-0 right-0 w-24 h-24 bg-white opacity-10 rounded-full translate-x-10 translate-y-10"></div>
        
        <img 
          src={candidate.photoUrl} 
          alt={candidate.name} 
          className="w-24 h-24 rounded-full border-4 border-white mx-auto shadow-lg object-cover"
        />
        <h2 className="text-2xl font-bold text-white mt-4">{candidate.name}</h2>
        <p className="text-blue-100">{candidate.education}</p>
      </div>

      <div className="p-6 space-y-6">
        <div className="space-y-4">
          <div className="flex items-center space-x-3 p-3 bg-blue-50 rounded-lg border border-blue-100">
            <GraduationCap className="text-blue-600 w-6 h-6 flex-shrink-0" />
            <div>
              <p className="text-xs text-blue-500 font-bold uppercase">í•™ë ¥ & ì „ê³µ</p>
              <p className="text-sm font-semibold text-gray-800">{candidate.major}</p>
            </div>
          </div>

          <div className="flex items-center space-x-3 p-3 bg-blue-50 rounded-lg border border-blue-100">
            <Award className="text-blue-600 w-6 h-6 flex-shrink-0" />
            <div>
              <p className="text-xs text-blue-500 font-bold uppercase">ì£¼ìš” ìˆ˜ìƒ</p>
              <p className="text-sm font-semibold text-gray-800">{candidate.summary[1]}</p>
            </div>
          </div>

          <div className="flex items-center space-x-3 p-3 bg-blue-50 rounded-lg border border-blue-100">
            <Briefcase className="text-blue-600 w-6 h-6 flex-shrink-0" />
            <div>
              <p className="text-xs text-blue-500 font-bold uppercase">ì£¼ìš” ê²½ë ¥</p>
              <p className="text-sm font-semibold text-gray-800">{candidate.summary[0]}</p>
            </div>
          </div>
        </div>

        <div className="bg-yellow-50 p-4 rounded-lg border border-yellow-200">
          <h3 className="text-yellow-800 font-bold text-sm mb-2 flex items-center">
            <span className="bg-yellow-500 w-2 h-2 rounded-full mr-2"></span>
            íƒì • ë…¸íŠ¸ (ì²«ì¸ìƒ)
          </h3>
          <p className="text-xs text-gray-600 leading-relaxed">
            "í•™ë²Œë„ ì¢‹ê³ , ëŒ€ê¸°ì—… ê²½ë ¥ì— ìˆ˜ìƒ ì‹¤ì ê¹Œì§€ ì™„ë²½í•´ ë³´ì…ë‹ˆë‹¤.
            ëŠ¥ë ¥ ìˆëŠ” ì¸ì¬ì„ì´ í‹€ë¦¼ì—†ì–´ ë³´ì…ë‹ˆë‹¤... ì •ë§ ê·¸ëŸ´ê¹Œìš”?"
          </p>
        </div>

        <button 
          onClick={() => {
            audioService.playClickSound();
            onNext();
          }}
          className="w-full bg-slate-900 text-white py-4 rounded-lg font-bold text-lg hover:bg-slate-800 transition-all flex items-center justify-center space-x-2 group shadow-lg"
        >
          <span>ì´ë ¥ì„œ ê²€ì¦ ì‹œì‘</span>
          <ArrowRight className="w-5 h-5 group-hover:translate-x-1 transition-transform" />
        </button>
      </div>
    </div>
  );
};

/* --- Bundled from InvestigationBoard.tsx --- */
import React, { useState } from 'react';

import { Search, AlertTriangle, CheckCircle } from 'lucide-react';


interface Props {
  candidate: Candidate;
  onComplete: (selectedIds: number[]) => void;
}

const InvestigationBoard: React.FC<Props> = ({ candidate, onComplete }) => {
  const [selectedIds, setSelectedIds] = useState<number[]>([]);

  const toggleSentence = (id: number) => {
    if (selectedIds.includes(id)) {
      audioService.playClickSound(); // Deselect sound
      setSelectedIds(prev => prev.filter(sid => sid !== id));
    } else {
      audioService.playAlertSound(); // Select sound (suspicious)
      setSelectedIds(prev => [...prev, id]);
    }
  };

  return (
    <div className="flex flex-col h-full max-w-2xl mx-auto w-full">
      {/* Header */}
      <div className="flex items-center justify-between p-4 bg-slate-800 rounded-t-xl border-b border-slate-700">
        <div className="flex items-center space-x-3">
          <div className="w-10 h-10 rounded-full overflow-hidden border-2 border-slate-500">
            <img src={candidate.photoUrl} alt="profile" className="w-full h-full object-cover" />
          </div>
          <div>
            <h3 className="text-white font-bold">{candidate.name}</h3>
            <p className="text-xs text-slate-400">{candidate.resumeTitle}</p>
          </div>
        </div>
        <div className="flex items-center space-x-2 bg-slate-900 px-3 py-1 rounded-full border border-slate-700">
          <Search className="w-4 h-4 text-yellow-400" />
          <span className="text-xs text-slate-300">
            ì˜ì‹¬ë˜ëŠ” ë¬¸ì¥: <span className="text-yellow-400 font-bold">{selectedIds.length}</span>ê°œ
          </span>
        </div>
      </div>

      {/* Document Viewer */}
      <div className="flex-1 bg-white p-6 md:p-8 overflow-y-auto shadow-inner relative">
        <div className="absolute top-0 left-0 w-full h-2 bg-gradient-to-b from-slate-200 to-transparent"></div>
        
        <h1 className="text-2xl font-bold text-slate-900 mb-6 pb-4 border-b-2 border-slate-200">
          ìê¸°ì†Œê°œì„œ
        </h1>

        <div className="space-y-4 text-lg leading-relaxed text-slate-700">
          {candidate.sentences && candidate.sentences.length > 0 ? (
            candidate.sentences.map((sentence) => (
              <span
                key={sentence.id}
                onClick={() => toggleSentence(sentence.id)}
                onMouseEnter={() => audioService.playHoverSound()}
                className={`
                  cursor-pointer inline transition-all duration-200 px-1 rounded decoration-2 underline-offset-4
                  ${selectedIds.includes(sentence.id) 
                    ? 'bg-red-100 text-red-900 decoration-red-500 underline font-semibold' 
                    : 'hover:bg-slate-100 hover:text-slate-900'}
                `}
              >
                {sentence.text}{' '}
              </span>
            ))
          ) : (
             <p className="text-red-500">ì´ë ¥ì„œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
          )}
        </div>
      </div>

      {/* Footer / Controls */}
      <div className="p-4 bg-slate-800 rounded-b-xl border-t border-slate-700">
        <div className="flex items-center justify-between">
          <p className="text-xs text-slate-400 max-w-[60%]">
            <AlertTriangle className="w-3 h-3 inline mr-1" />
            íŒ: ê³¼ì¥ë˜ê±°ë‚˜ êµ¬ì²´ì ì¸ ê·¼ê±°ê°€ ì—†ëŠ” ë¬¸ì¥ì„ í´ë¦­í•˜ì„¸ìš”.
          </p>
          <button
            onClick={() => {
              audioService.playSuccessSound();
              onComplete(selectedIds);
            }}
            className="bg-blue-600 hover:bg-blue-500 text-white px-6 py-2 rounded-lg font-bold shadow-lg transition-colors flex items-center"
          >
            <CheckCircle className="w-4 h-4 mr-2" />
            ê²€ì¦ ì™„ë£Œ
          </button>
        </div>
      </div>
    </div>
  );
};

/* --- Bundled from ReportCard.tsx --- */
import React from 'react';

import { RefreshCcw, ShieldAlert, BadgeCheck, XCircle, AlertTriangle } from 'lucide-react';


interface Props {
  candidate: Candidate;
  result: ScanResult;
  selectedIds: number[];
  onRestart: () => void;
}

const ReportCard: React.FC<Props> = ({ candidate, result, selectedIds, onRestart }) => {
  return (
    <div className="max-w-3xl w-full mx-auto bg-slate-800 rounded-xl shadow-2xl overflow-hidden border border-slate-700 animate-fade-in">
      <div className="p-6 bg-slate-900 border-b border-slate-700 flex justify-between items-center">
        <h2 className="text-xl font-bold text-white flex items-center">
          <ShieldAlert className="w-6 h-6 mr-2 text-yellow-400" />
          ê²€ì¦ ë¦¬í¬íŠ¸
        </h2>
        <div className="text-right">
          <p className="text-xs text-slate-400">í›„ê´‘ íš¨ê³¼ ë¯¼ê°ë„</p>
          <p className={`text-2xl font-black ${result.haloScore > 50 ? 'text-red-400' : 'text-green-400'}`}>
            {result.haloScore}ì 
          </p>
        </div>
      </div>

      <div className="p-6 overflow-y-auto max-h-[60vh]">
        <div className="mb-6">
          <p className="text-slate-300 text-sm mb-4">
            {result.haloScore > 50 
              ? 'ë‹¹ì‹ ì€ í™”ë ¤í•œ í•™ë²Œê³¼ ê²½ë ¥(í›„ê´‘)ì— í˜„í˜¹ë˜ì–´ ì¤‘ìš”í•œ ë‹¨ì„œë“¤ì„ ë†“ì³¤ìŠµë‹ˆë‹¤. ê²‰ëª¨ìŠµë³´ë‹¤ êµ¬ì²´ì ì¸ ê·¼ê±°ë¥¼ í™•ì¸í•˜ëŠ” ìŠµê´€ì´ í•„ìš”í•©ë‹ˆë‹¤.' 
              : 'í›Œë¥­í•©ë‹ˆë‹¤! ê²‰ìœ¼ë¡œ ë³´ì´ëŠ” í™”ë ¤í•¨ì— ì†ì§€ ì•Šê³  ëƒ‰ì² í•˜ê²Œ ì‚¬ì‹¤ ê´€ê³„ë¥¼ íŒŒì•…í–ˆìŠµë‹ˆë‹¤.'}
          </p>
        </div>

        <div className="space-y-4">
          {candidate.sentences && candidate.sentences.map((sentence) => {
            const isSelected = selectedIds.includes(sentence.id);
            const isSuspicious = sentence.type === 'exaggeration' || sentence.type === 'vague' || sentence.type === 'halo';
            
            // Logic for visual feedback
            let statusColor = 'border-slate-600';
            let statusIcon = null;
            let statusText = '';

            if (isSuspicious && isSelected) {
              // Caught correctly
              statusColor = 'border-green-500 bg-green-900/20';
              statusIcon = <BadgeCheck className="w-5 h-5 text-green-400" />;
              statusText = 'ì •ë‹µ! ê³¼ì¥/í›„ê´‘ íƒì§€ ì„±ê³µ';
            } else if (isSuspicious && !isSelected) {
              // Missed
              statusColor = 'border-red-500 bg-red-900/20';
              statusIcon = <XCircle className="w-5 h-5 text-red-400" />;
              statusText = 'ë†“ì¹¨! ì˜ì‹¬í–ˆì–´ì•¼ í•¨';
            } else if (!isSuspicious && isSelected) {
              // False Alarm
              statusColor = 'border-yellow-500 bg-yellow-900/20';
              statusIcon = <AlertTriangle className="w-5 h-5 text-yellow-400" />;
              statusText = 'ì˜¤í•´! ì •ìƒì ì¸ ë¬¸ì¥ì„';
            } else {
              // Normal and ignored (Correct)
              statusColor = 'border-slate-700 opacity-50';
            }

            if (statusColor.includes('opacity-50')) return null; // Only show significant results to reduce noise

            return (
              <div key={sentence.id} className={`p-4 rounded-lg border ${statusColor}`}>
                <div className="flex justify-between items-start mb-2">
                  <div className="flex items-center space-x-2">
                    {statusIcon}
                    <span className="text-sm font-bold text-slate-200">{statusText}</span>
                  </div>
                  <span className="text-xs px-2 py-1 rounded bg-slate-700 text-slate-300 uppercase">
                    {sentence.type === 'halo' ? 'í›„ê´‘íš¨ê³¼' : sentence.type === 'exaggeration' ? 'ê³¼ì¥ë¨' : 'ëª¨í˜¸í•¨'}
                  </span>
                </div>
                <p className="text-slate-300 mb-2 italic">"{sentence.text}"</p>
                <p className="text-sm text-slate-400 bg-slate-900/50 p-2 rounded">
                  ğŸ’¡ <span className="text-slate-200">{sentence.reason}</span>
                </p>
              </div>
            );
          })}
        </div>
      </div>

      <div className="p-4 bg-slate-900 border-t border-slate-700 flex justify-center">
        <button
          onClick={() => {
            audioService.playClickSound();
            onRestart();
          }}
          className="flex items-center space-x-2 bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-3 rounded-full font-bold transition-all shadow-lg hover:shadow-indigo-500/30"
        >
          <RefreshCcw className="w-5 h-5" />
          <span>ë‹¤ë¥¸ ì§€ì›ì ë¶„ì„í•˜ê¸°</span>
        </button>
      </div>
    </div>
  );
};

/* --- Bundled from audioService.ts --- */
class AudioService {
  private context: AudioContext | null = null;

  private getContext(): AudioContext {
    if (!this.context) {
      this.context = new (window.AudioContext || (window as any).webkitAudioContext)();
    }
    return this.context;
  }

  public init() {
    // Resume context if suspended (browser autoplay policy)
    const ctx = this.getContext();
    if (ctx.state === 'suspended') {
      ctx.resume();
    }
  }

  public playHoverSound() {
    const ctx = this.getContext();
    const osc = ctx.createOscillator();
    const gain = ctx.createGain();

    osc.type = 'sine';
    osc.frequency.setValueAtTime(400, ctx.currentTime);
    osc.frequency.exponentialRampToValueAtTime(600, ctx.currentTime + 0.05);
    
    gain.gain.setValueAtTime(0.05, ctx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.05);

    osc.connect(gain);
    gain.connect(ctx.destination);
    osc.start();
    osc.stop(ctx.currentTime + 0.05);
  }

  public playClickSound() {
    const ctx = this.getContext();
    const osc = ctx.createOscillator();
    const gain = ctx.createGain();

    osc.type = 'square';
    osc.frequency.setValueAtTime(200, ctx.currentTime);
    osc.frequency.exponentialRampToValueAtTime(50, ctx.currentTime + 0.1);

    gain.gain.setValueAtTime(0.1, ctx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.1);

    osc.connect(gain);
    gain.connect(ctx.destination);
    osc.start();
    osc.stop(ctx.currentTime + 0.1);
  }

  public playSuccessSound() {
    const ctx = this.getContext();
    const osc = ctx.createOscillator();
    const gain = ctx.createGain();

    osc.type = 'triangle';
    osc.frequency.setValueAtTime(440, ctx.currentTime);
    osc.frequency.setValueAtTime(554, ctx.currentTime + 0.1); // C#
    osc.frequency.setValueAtTime(659, ctx.currentTime + 0.2); // E

    gain.gain.setValueAtTime(0.1, ctx.currentTime);
    gain.gain.linearRampToValueAtTime(0, ctx.currentTime + 0.6);

    osc.connect(gain);
    gain.connect(ctx.destination);
    osc.start();
    osc.stop(ctx.currentTime + 0.6);
  }

  public playAlertSound() {
    const ctx = this.getContext();
    const osc = ctx.createOscillator();
    const gain = ctx.createGain();

    osc.type = 'sawtooth';
    osc.frequency.setValueAtTime(150, ctx.currentTime);
    osc.frequency.linearRampToValueAtTime(100, ctx.currentTime + 0.2);

    gain.gain.setValueAtTime(0.1, ctx.currentTime);
    gain.gain.linearRampToValueAtTime(0, ctx.currentTime + 0.3);

    osc.connect(gain);
    gain.connect(ctx.destination);
    osc.start();
    osc.stop(ctx.currentTime + 0.3);
  }
}

const audioService = new AudioService();

/* --- Bundled from scenarioService.ts --- */

import { GoogleGenAI, Type } from "@google/genai";

// Fallback data in case API fails or for initial testing
const FALLBACK_CANDIDATE: Candidate = {
  id: 'c_001',
  name: 'ê¹€í•˜ì¤€',
  age: 29,
  photoUrl: 'https://picsum.photos/seed/c_001/200/200',
  education: 'ì„œìš¸ëŒ€í•™êµ ê²½ì˜í•™ê³¼ ì¡¸ì—…',
  major: 'ê²½ì˜í•™ / ë²¤ì²˜ì°½ì—… ì—°ê³„ì „ê³µ',
  summary: [
    'ê¸€ë¡œë²Œ ëŒ€ê¸°ì—… Aì‚¬ ì „ëµê¸°íšì‹¤ ê·¼ë¬´',
    'ì•„ì‹œì•„ ëŒ€í•™ìƒ í˜ì‹  ì±Œë¦°ì§€ ëŒ€ìƒ',
    'TEDx Youth ì—°ì‚¬ ("ì‹¤íŒ¨ë¥¼ ë‘ë ¤ì›Œí•˜ì§€ ì•ŠëŠ” ë²•")'
  ],
  resumeTitle: 'ë°ì´í„° ê¸°ë°˜ì˜ í˜ì‹ ì„ ì£¼ë„í•˜ëŠ” ì „ëµê°€',
  sentences: [
    {
      id: 1,
      text: 'ì €ëŠ” ì„œìš¸ëŒ€í•™êµì—ì„œ ê²½ì˜í•™ì„ ì „ê³µí•˜ë©° ë…¼ë¦¬ì  ì‚¬ê³ ì™€ ë¦¬ë”ì‹­ì„ ê¸¸ë €ìŠµë‹ˆë‹¤.',
      type: 'halo',
      reason: 'í•™ë²Œì„ ê°•ì¡°í•˜ì—¬ ì‹ ë¢°ë¥¼ ì–»ìœ¼ë ¤ëŠ” ì „í˜•ì ì¸ í›„ê´‘ íš¨ê³¼ ë¬¸ì¥ì…ë‹ˆë‹¤. ì‚¬ì‹¤ ìì²´ëŠ” ë¬¸ì œê°€ ì—†ìœ¼ë‚˜ íŒë‹¨ì„ íë¦¬ê²Œ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.'
    },
    {
      id: 2,
      text: 'ì¡¸ì—… í›„ Aì‚¬ ì „ëµê¸°íšì‹¤ì—ì„œ ê·¼ë¬´í•˜ë©° ì „ì‚¬ ë§¤ì¶œì„ 30% í–¥ìƒì‹œí‚¤ëŠ” ë° í•µì‹¬ì ì¸ ê¸°ì—¬ë¥¼ í–ˆìŠµë‹ˆë‹¤.',
      type: 'exaggeration',
      reason: 'ì‹ ì…/ì£¼ë‹ˆì–´ ì‚¬ì›ì´ ì „ì‚¬ ë§¤ì¶œ 30%ì— "í•µì‹¬ ê¸°ì—¬"ë¥¼ í–ˆë‹¤ëŠ” ê²ƒì€ ê³¼ì¥ì¼ ê°€ëŠ¥ì„±ì´ ë§¤ìš° ë†’ìŠµë‹ˆë‹¤. êµ¬ì²´ì  ë°©ë²•ë¡ ì´ ë¹ ì ¸ìˆìŠµë‹ˆë‹¤.'
    },
    {
      id: 3,
      text: 'íŠ¹íˆ ì œê°€ ë„ì…í•œ ìƒˆë¡œìš´ ë°ì´í„° ë¶„ì„ íˆ´ì€ íŒ€ì˜ ì—…ë¬´ íš¨ìœ¨ì„ íšê¸°ì ìœ¼ë¡œ ê°œì„ í–ˆìŠµë‹ˆë‹¤.',
      type: 'vague',
      reason: '"íšê¸°ì "ì´ë¼ëŠ” í‘œí˜„ì€ ëª¨í˜¸í•©ë‹ˆë‹¤. ì‹œê°„ ë‹¨ì¶• ìˆ˜ì¹˜ë‚˜ ë¹„ìš© ì ˆê°ì•¡ ë“± êµ¬ì²´ì  ì§€í‘œê°€ ì—†ìŠµë‹ˆë‹¤.'
    },
    {
      id: 4,
      text: 'ì´í›„ ìŠ¤íƒ€íŠ¸ì—… Bì‚¬ë¡œ ì´ì§í•˜ì—¬ ë§ˆì¼€íŒ… íŒ€ì¥ìœ¼ë¡œì„œ 6ê°œì›”ê°„ ê·¼ë¬´í–ˆìŠµë‹ˆë‹¤.',
      type: 'fact',
      reason: 'ë‹¨ìˆœí•œ ì‚¬ì‹¤ ê´€ê³„ì…ë‹ˆë‹¤. í•˜ì§€ë§Œ 6ê°œì›”ì´ë¼ëŠ” ì§§ì€ ì¬ì§ ê¸°ê°„ì€ "ì™œ?"ë¼ëŠ” ì˜ë¬¸ì„ ê°€ì ¸ì•¼ í•  í¬ì¸íŠ¸ì…ë‹ˆë‹¤.'
    },
    {
      id: 5,
      text: 'TEDx ê°•ì—° ê²½í—˜ì„ ë°”íƒ•ìœ¼ë¡œ, ì²­ì¤‘ì„ ì‚¬ë¡œì¡ëŠ” í”„ë ˆì  í…Œì´ì…˜ ìŠ¤í‚¬ì„ ë³´ìœ í•˜ê³  ìˆìŠµë‹ˆë‹¤.',
      type: 'halo',
      reason: 'ìœ ëª… ë¸Œëœë“œ(TEDx)ë¥¼ ì–¸ê¸‰í•˜ì—¬ ê¶Œìœ„ë¥¼ ë¹Œë ¤ì˜¤ê³  ìˆìŠµë‹ˆë‹¤. ì‹¤ì œ ê°•ì—°ì˜ ê·œëª¨ë‚˜ ì£¼ì œ ì í•©ì„±ì„ ë”°ì ¸ë´ì•¼ í•©ë‹ˆë‹¤.'
    }
  ]
};

const fetchRandomCandidate = async (): Promise<Candidate> => {
  try {
    const apiKey = process.env.API_KEY;
    if (!apiKey) {
      console.warn("No API Key found, using fallback data.");
      return FALLBACK_CANDIDATE;
    }

    const ai = new GoogleGenAI({ apiKey });
    
    // Randomize the role to ensure diversity
    const roles = ['Software Engineer', 'Product Manager', 'Digital Marketer', 'Data Scientist', 'Sales Specialist', 'UX Designer'];
    const randomRole = roles[Math.floor(Math.random() * roles.length)];

    const prompt = `
      Create a profile for a job applicant in a simulation game called "Resume Detective".
      Role: ${randomRole}
      Language: Korean (Must be natural Korean)

      The goal of the game is for the user to detect lies, exaggerations, and "Halo Effect" (using prestigious names/awards to mask lack of substance).

      Please generate a JSON object.
      
      CRITICAL INSTRUCTION: You MUST include the 'sentences' array with 5 to 7 items.
      
      Structure requirements:
      1. id: unique string
      2. name: Korean name
      3. age: number (20-35)
      4. education: Prestigious university in Korea or abroad (to trigger Halo Effect)
      5. major: Major related to the role
      6. summary: 3 very impressive bullet points (e.g., worked at Big Tech, won grand awards)
      7. resumeTitle: Catchy, slightly overconfident title
      8. sentences: An array of 5-7 self-introduction sentences. 
         - Mix 'fact', 'exaggeration', 'halo', and 'vague' types.
         - 'halo': Mentions prestigious names (Harvard, Google, Samsung, etc.) to sound good.
         - 'exaggeration': Claims unrealistic results (e.g., "Tripled revenue in 1 month") without proof.
         - 'vague': Uses buzzwords like "innovative", "synergy", "paradigm shift" without specifics.
         - 'fact': Boring but true facts.
         - For each sentence, provide a 'reason' explaining why it is suspicious or safe.
         - 'type' should be one of: 'fact', 'exaggeration', 'halo', 'vague'.
    `;

    const response = await ai.models.generateContent({
      model: 'gemini-2.5-flash',
      contents: prompt,
      config: {
        responseMimeType: "application/json",
        responseSchema: {
          type: Type.OBJECT,
          properties: {
            id: { type: Type.STRING },
            name: { type: Type.STRING },
            age: { type: Type.INTEGER },
            education: { type: Type.STRING },
            major: { type: Type.STRING },
            summary: {
              type: Type.ARRAY,
              items: { type: Type.STRING }
            },
            resumeTitle: { type: Type.STRING },
            sentences: {
              type: Type.ARRAY,
              items: {
                type: Type.OBJECT,
                properties: {
                  id: { type: Type.INTEGER },
                  text: { type: Type.STRING },
                  type: { type: Type.STRING },
                  reason: { type: Type.STRING }
                },
                required: ["id", "text", "type", "reason"]
              }
            }
          },
          required: ["id", "name", "age", "education", "major", "summary", "resumeTitle", "sentences"]
        }
      }
    });

    if (!response.text) {
        throw new Error("No text returned from AI");
    }

    const data = JSON.parse(response.text);
    
    // Critical Validation: Ensure sentences exist and is an array
    if (!data.sentences || !Array.isArray(data.sentences) || data.sentences.length === 0) {
        console.error("Invalid AI Data Structure:", data);
        throw new Error("Candidate data missing valid sentences array");
    }

    // Add a consistent photo based on ID
    return {
      ...data,
      photoUrl: `https://picsum.photos/seed/${data.id || Math.random()}/200/200`
    };

  } catch (error) {
    console.error("Failed to generate candidate:", error);
    return FALLBACK_CANDIDATE;
  }
};

/* --- Bundled from App.tsx --- */
import React, { useState } from 'react';






import { Search, Loader2 } from 'lucide-react';

function App() {
  const [gameState, setGameState] = useState<GameState>('intro');
  const [candidate, setCandidate] = useState<Candidate | null>(null);
  const [selectedIds, setSelectedIds] = useState<number[]>([]);
  const [scanResult, setScanResult] = useState<ScanResult | null>(null);
  const [isLoading, setIsLoading] = useState(false);

  const startGame = async () => {
    audioService.init();
    audioService.playClickSound();
    
    setIsLoading(true);
    try {
      const newCandidate = await fetchRandomCandidate();
      setCandidate(newCandidate);
      setGameState('briefing');
    } catch (e) {
      console.error(e);
      alert("ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
    } finally {
      setIsLoading(false);
    }
  };

  const handleBriefingComplete = () => {
    setGameState('investigation');
  };

  const handleInvestigationComplete = (ids: number[]) => {
    if (!candidate) return;

    setSelectedIds(ids);
    
    // Calculate Results
    const suspiciousSentences = candidate.sentences.filter(
      s => s.type === 'exaggeration' || s.type === 'halo' || s.type === 'vague'
    );
    const normalSentences = candidate.sentences.filter(s => s.type === 'fact');

    const suspiciousFound = ids.filter(id => 
      suspiciousSentences.find(s => s.id === id)
    ).length;

    const falseAlarms = ids.filter(id => 
      normalSentences.find(s => s.id === id)
    ).length;

    const missed = suspiciousSentences.length - suspiciousFound;

    // Simple Halo Score Logic
    let score = 0;
    if (suspiciousSentences.length > 0) {
      score = Math.round(((missed + (falseAlarms * 0.5)) / suspiciousSentences.length) * 100);
    }
    score = Math.min(100, score);

    setScanResult({
      totalSentences: candidate.sentences.length,
      suspiciousFound,
      falseAlarms,
      missed,
      haloScore: score
    });

    setGameState('report');
  };

  const restartGame = () => {
    // Reset and start over with a new candidate
    setScanResult(null);
    setSelectedIds([]);
    startGame();
  };

  if (isLoading) {
    return (
      <div className="min-h-screen bg-slate-900 flex flex-col items-center justify-center text-white space-y-4">
        <div className="relative w-24 h-24 border-4 border-slate-700 rounded-lg overflow-hidden bg-slate-800 shadow-2xl">
          <div className="absolute top-0 left-0 w-full h-1 bg-green-400 shadow-[0_0_10px_#4ade80] animate-scan"></div>
          <div className="flex items-center justify-center h-full">
            <Loader2 className="w-8 h-8 animate-spin text-slate-500" />
          </div>
        </div>
        <p className="text-xl font-bold animate-pulse text-green-400 font-mono">
          ì§€ì›ì ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤ìº” ì¤‘...
        </p>
        <p className="text-xs text-slate-500">AIê°€ ìƒˆë¡œìš´ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-slate-900 flex flex-col items-center justify-center p-4">
      
      {/* Background Ambience */}
      <div className="fixed inset-0 pointer-events-none opacity-20 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-blue-900 via-slate-900 to-black"></div>

      {gameState === 'intro' && (
        <div className="z-10 text-center space-y-8 animate-fade-in">
          <div className="relative inline-block">
            <Search className="w-20 h-20 text-blue-500 mx-auto mb-4 animate-bounce" />
            <div className="absolute -bottom-2 w-full h-4 bg-blue-500/50 blur-xl rounded-full"></div>
          </div>
          <h1 className="text-5xl md:text-6xl font-black text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-emerald-400 tracking-tight">
            RESUME DETECTIVE
          </h1>
          <p className="text-slate-400 text-lg md:text-xl max-w-lg mx-auto">
            í™”ë ¤í•œ ìŠ¤í™ ë’¤ì— ìˆ¨ê²¨ì§„ 'ì§„ì‹¤'ì„ ì°¾ìœ¼ì„¸ìš”.<br/>
            í›„ê´‘ íš¨ê³¼ì— ì†ì§€ ì•ŠëŠ” ëƒ‰ì² í•œ íƒì •ì´ ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.
          </p>
          <button 
            onClick={startGame}
            className="group relative px-8 py-4 bg-blue-600 rounded-full font-bold text-xl text-white shadow-lg shadow-blue-500/30 overflow-hidden hover:scale-105 transition-transform"
          >
            <div className="absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform duration-300"></div>
            <span className="relative">ìˆ˜ì‚¬ ì‹œì‘í•˜ê¸°</span>
          </button>
        </div>
      )}

      {gameState === 'briefing' && candidate && (
        <div className="z-10 w-full flex justify-center">
          <BriefingCard 
            candidate={candidate} 
            onNext={handleBriefingComplete} 
          />
        </div>
      )}

      {gameState === 'investigation' && candidate && (
        <div className="z-10 w-full h-[80vh] flex justify-center">
          <InvestigationBoard 
            candidate={candidate} 
            onComplete={handleInvestigationComplete} 
          />
        </div>
      )}

      {gameState === 'report' && candidate && scanResult && (
        <div className="z-10 w-full flex justify-center">
          <ReportCard 
            candidate={candidate} 
            result={scanResult} 
            selectedIds={selectedIds}
            onRestart={restartGame}
          />
        </div>
      )}
    </div>
  );
}

/* --- Bundled from types.ts --- */
export interface Sentence {
  id: number;
  text: string;
  type: 'fact' | 'exaggeration' | 'halo' | 'vague';
  reason: string; // Why it is trustworthy or suspicious
}

export interface Candidate {
  id: string;
  name: string;
  age: number;
  photoUrl: string;
  education: string;
  major: string;
  summary: string[]; // Highly impressive summary points (Halo triggers)
  resumeTitle: string;
  sentences: Sentence[];
}

export type GameState = 'intro' | 'briefing' | 'investigation' | 'report';

export interface ScanResult {
  totalSentences: number;
  suspiciousFound: number;
  falseAlarms: number;
  missed: number;
  haloScore: number; // 0 to 100, higher means more susceptible to Halo Effect
}

/* --- Bundled from vite.config.ts --- */
import path from 'path';
import { defineConfig, loadEnv } from 'vite';
import react from '@vitejs/plugin-react';

defineConfig(({ mode }) => {
    const env = loadEnv(mode, '.', '');
    return {
      server: {
        port: 3000,
        host: '0.0.0.0',
      },
      plugins: [react()],
      define: {
        'process.env.API_KEY': JSON.stringify(env.GEMINI_API_KEY),
        'process.env.GEMINI_API_KEY': JSON.stringify(env.GEMINI_API_KEY)
      },
      resolve: {
        alias: {
          '@': path.resolve(__dirname, '.'),
        }
      }
    };
});


/* --- Bundled from index.tsx --- */
import React from 'react';
import ReactDOM from 'react-dom/client';


const rootElement = document.getElementById('root');
if (!rootElement) {
  throw new Error("Could not find root element to mount to");
}

const root = ReactDOM.createRoot(rootElement);
root.render(
  <React.StrictMode>
    <App />
  </React.StrictMode>
);

    </script>
    <script>
      window.addEventListener('load', function() {
        if (window.Babel) {
          window.Babel.transformScriptTags();
        }
      });
    </script>
    
</body>
</html>